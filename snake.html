<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>YHAZ Snake - Mobile Game</title>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#000; --fg:#fff; --muted:#888; --accent:#fff;
  --danger:#ff4d4d; --ok:#5cff5c;
}
*{box-sizing:border-box}
html,body{height:100%; margin:0; background:var(--bg); color:var(--fg); font-family:'VT323',monospace;}
body{display:flex; flex-direction:column;}
header{display:flex; align-items:center; justify-content:center; padding:6px; position:relative;}
.home-btn{position:absolute; left:12px; background:none; border:none; color:var(--fg); font-family:'VT323'; font-size:16px; cursor:pointer; padding:4px 8px; border-radius:4px;}
.home-btn:hover{background:rgba(255,255,255,0.1);}
h1{margin:0; font-size:28px; text-shadow:0 0 6px #fff;}
.kbd{color:var(--muted); font-size:12px; margin-top:2px;}
.game-container{flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:4px; width:100%;}
.canvas-wrapper{display:flex; justify-content:center; align-items:center; width:100%; max-width:480px; aspect-ratio:1/1; margin:0 auto;}
canvas{background:#000; border:1px solid rgba(255,255,255,0.08); width:100%; height:100%; display:block;}
.info{display:flex; gap:12px; justify-content:center; font-size:14px; margin-top:4px;}
.controls{display:flex; gap:6px; justify-content:center; flex-wrap:wrap; margin:6px 0; width:100%; max-width:480px;}
.btn{flex:1; min-width:60px; border:1px solid var(--fg); padding:12px 0; background:transparent; color:var(--fg); cursor:pointer; font-family:'VT323'; text-transform:uppercase; font-size:16px; border-radius:8px; max-width:120px;}
.btn:hover{background:var(--fg); color:var(--bg);}
.touch-grid{display:flex; flex-direction:column; gap:6px; justify-content:center; align-items:center; margin-bottom:12px;}
.pad-row{display:flex; gap:8px;}
.pad{width:70px; height:70px; border:1px solid var(--fg); display:flex; align-items:center; justify-content:center; font-size:26px; border-radius:12px; user-select:none; touch-action:none;}
footer{text-align:center; color:var(--muted); font-size:12px; padding:6px;}

/* Miglioramenti per desktop */
@media (min-width: 768px) {
  .btn{max-width:140px; padding:14px 0; font-size:18px;}
  .pad{width:80px; height:80px; font-size:28px;}
  h1{font-size:32px;}
}

/* Miglioramenti per mobile */
@media (max-width: 480px) {
  .canvas-wrapper{margin:0 8px;}
  .controls{gap:4px; padding:0 8px;}
  .btn{min-width:50px; font-size:14px; padding:10px 0;}
  .pad{width:60px; height:60px; font-size:22px;}
}
</style>
</head>
<body>
<header>
  <button class="home-btn" id="home">HOME</button>
  <div style="text-align:center;">
    <h1>YHAZ SNAKE</h1>
    <div class="kbd">Arrow/WASD • Touch/Swipe • Space pausa</div>
  </div>
</header>

<div class="game-container">
  <div class="canvas-wrapper">
    <canvas id="c" width="480" height="480" role="img" aria-label="Campo Snake"></canvas>
  </div>

  <div class="info">
    <div>Score <strong id="score">0</strong></div>
    <div>•</div>
    <div>Best <strong id="best">0</strong></div>
    <div>•</div>
    <div>Speed <strong id="spd">1</strong></div>
  </div>

  <div class="controls">
    <button class="btn" id="startBtn">Start</button>
    <button class="btn" id="pauseBtn">Pause</button>
    <button class="btn" id="restartBtn">Restart</button>
    <button class="btn" id="wrapBtn">Wrap: Off</button>
  </div>

  <div class="touch-grid">
    <div class="pad" id="upPad">▲</div>
    <div class="pad-row">
      <div class="pad" id="leftPad">◀</div>
      <div class="pad" id="downPad">▼</div>
      <div class="pad" id="rightPad">▶</div>
    </div>
  </div>
</div>

<footer>© 2025 YHAZ — Snake • VT323 look</footer>

<script>
(() => {
const canvas=document.getElementById('c');
const ctx=canvas.getContext('2d');
const scoreEl=document.getElementById('score');
const bestEl=document.getElementById('best');
const spdEl=document.getElementById('spd');
const startBtn=document.getElementById('startBtn');
const pauseBtn=document.getElementById('pauseBtn');
const restartBtn=document.getElementById('restartBtn');
const wrapBtn=document.getElementById('wrapBtn');
const upPad=document.getElementById('upPad');
const downPad=document.getElementById('downPad');
const leftPad=document.getElementById('leftPad');
const rightPad=document.getElementById('rightPad');
const homeBtn=document.getElementById('home');

const COLS=20, ROWS=20, CELL=Math.floor(canvas.width/COLS);
const center={x:Math.floor(COLS/2),y:Math.floor(ROWS/2)};
let snake=[], dir={x:0,y:0}, dirQueue=[], food=null;
let running=false, paused=false, gameOver=false, score=0;
let best=parseInt(localStorage.getItem('yhaz_snake_best')||'0',10)||0;
bestEl.textContent=best;
let speedLevel=6, wrap=false;
let lastTime=0, acc=0, tickInterval=1000/speedLevel;

function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function resetGame(){
  snake=[{x:center.x,y:center.y},{x:center.x-1,y:center.y},{x:center.x-2,y:center.y}];
  dir={x:1,y:0}; dirQueue=[]; spawnFood(); score=0; gameOver=false; paused=false; running=false; speedLevel=6; tickInterval=1000/speedLevel; updateUI(); render();
}
function startGame(){if(!running){running=true; paused=false; lastTime=performance.now(); requestAnimationFrame(loop);}}
function pauseToggle(){if(!running) return; paused=!paused; if(!paused){lastTime=performance.now(); requestAnimationFrame(loop);}}
function restartGame(){resetGame(); startGame();}
function updateUI(){scoreEl.textContent=score; bestEl.textContent=best; spdEl.textContent=speedLevel; wrapBtn.textContent='Wrap: '+(wrap?'On':'Off');}
function spawnFood(){let tries=0; while(true){const x=randInt(0,COLS-1), y=randInt(0,ROWS-1); if(!snake.some(s=>s.x===x&&s.y===y)){food={x,y}; break;} if(++tries>500) break;}}
function step(){
  if(gameOver||paused) return;
  if(dirQueue.length){const nd=dirQueue.shift(); if(!(nd.x===-dir.x&&nd.y===-dir.y)) dir=nd;}
  const head={x:snake[0].x+dir.x, y:snake[0].y+dir.y};
  if(wrap){head.x=(head.x+COLS)%COLS; head.y=(head.y+ROWS)%ROWS;}
  else{if(head.x<0||head.x>=COLS||head.y<0||head.y>=ROWS) return lose();}
  if(snake.some(seg=>seg.x===head.x&&seg.y===head.y)) return lose();
  snake.unshift(head);
  if(food && head.x===food.x && head.y===food.y){
    score++; if(score%4===0){speedLevel=Math.min(20,speedLevel+1); tickInterval=1000/speedLevel;} spawnFood(); updateUI();
  } else snake.pop();
}
function lose(){gameOver=true; running=false; if(score>best){best=score; localStorage.setItem('yhaz_snake_best',String(best));} updateUI(); render(); setTimeout(()=>alert('Game Over — Score: '+score),80);}
function render(){
  ctx.fillStyle='#000'; ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.strokeStyle='rgba(255,255,255,0.04)'; ctx.lineWidth=1;
  for(let i=0;i<=COLS;i++){ctx.beginPath();ctx.moveTo(i*CELL,0);ctx.lineTo(i*CELL,canvas.height);ctx.stroke();}
  for(let j=0;j<=ROWS;j++){ctx.beginPath();ctx.moveTo(0,j*CELL);ctx.lineTo(canvas.width,j*CELL);ctx.stroke();}
  if(food) drawCell(food.x,food.y,'#ffcc00');
  snake.forEach((seg,idx)=>drawCell(seg.x,seg.y,idx===0?'#fff':'#bfbfbf'));
  ctx.fillStyle='#fff'; ctx.font='14px VT323, monospace'; ctx.textAlign='left'; ctx.fillText('Score: '+score,6,18);
  ctx.textAlign='right'; ctx.fillText('Best: '+best,canvas.width-6,18);
  if(paused){ctx.fillStyle='rgba(0,0,0,0.6)';ctx.fillRect(0,0,canvas.width,canvas.height); ctx.fillStyle='#fff'; ctx.font='28px VT323, monospace'; ctx.textAlign='center'; ctx.fillText('PAUSED',canvas.width/2,canvas.height/2);}
  if(gameOver){ctx.fillStyle='rgba(0,0,0,0.6)';ctx.fillRect(0,0,canvas.width,canvas.height); ctx.fillStyle='#ff4d4d'; ctx.font='28px VT323, monospace'; ctx.textAlign='center'; ctx.fillText('GAME OVER',canvas.width/2,canvas.height/2-10); ctx.fillStyle='#fff'; ctx.font='16px VT323, monospace'; ctx.fillText('Press Restart',canvas.width/2,canvas.height/2+20);}
}
function drawCell(x,y,color){const px=x*CELL, py=y*CELL; ctx.fillStyle=color; ctx.fillRect(px+1,py+1,CELL-2,CELL-2); ctx.strokeStyle='rgba(0,0,0,0.12)'; ctx.strokeRect(px+1.5,py+1.5,CELL-3,CELL-3);}
function loop(ts){if(!running) return; const dt=ts-lastTime; lastTime=ts; acc+=dt; while(acc>=tickInterval){acc-=tickInterval; if(!paused&&!gameOver) step();} render(); requestAnimationFrame(loop);}
const keyMap={'ArrowUp':{x:0,y:-1},'ArrowDown':{x:0,y:1},'ArrowLeft':{x:-1,y:0},'ArrowRight':{x:1,y:0},'w':{x:0,y:-1},'s':{x:0,y:1},'a':{x:-1,y:0},'d':{x:1,y:0}};
window.addEventListener('keydown',(e)=>{const k=e.key; if(k===' '){e.preventDefault(); pauseToggle(); return;} const map=keyMap[k]||keyMap[k.toLowerCase()]; if(map) queueDir(map); if(k==='p'||k==='P') pauseToggle();});
function queueDir(d){const lastDir=dirQueue.length?dirQueue[dirQueue.length-1]:dir; if(d.x===-lastDir.x&&d.y===-lastDir.y) return; dirQueue.push(d); if(dirQueue.length>3) dirQueue.shift();}
upPad.addEventListener('pointerdown',()=>queueDir({x:0,y:-1}));
downPad.addEventListener('pointerdown',()=>queueDir({x:0,y:1}));
leftPad.addEventListener('pointerdown',()=>queueDir({x:-1,y:0}));
rightPad.addEventListener('pointerdown',()=>queueDir({x:1,y:0}));
(function setupSwipe(){let sx=0,sy=0; canvas.addEventListener('pointerdown',e=>{sx=e.clientX; sy=e.clientY;}); canvas.addEventListener('pointerup',e=>{const dx=e.clientX-sx,dy=e.clientY-sy,adx=Math.abs(dx),ady=Math.abs(dy); if(Math.max(adx,ady)<20) return; if(adx>ady) queueDir(dx>0?{x:1,y:0}:{x:-1,y:0}); else queueDir(dy>0?{x:0,y:1}:{x:0,y:-1});});})();
startBtn.addEventListener('click',()=>{if(!running){startGame(); lastTime=performance.now(); acc=0; requestAnimationFrame(loop);}});
pauseBtn.addEventListener('click',()=>pauseToggle());
restartBtn.addEventListener('click',()=>{resetGame(); startGame(); lastTime=performance.now(); acc=0; requestAnimationFrame(loop);});
wrapBtn.addEventListener('click',()=>{wrap=!wrap; updateUI();});
homeBtn.addEventListener('click',()=>{if(confirm('Tornare alla home? Il gioco in corso verrà interrotto.')){window.location.href='index.html';}});
function scaleCanvas(){const parent=canvas.parentElement; const maxSize=Math.min(window.innerWidth*0.9,480); parent.style.width=maxSize+'px'; parent.style.height=maxSize+'px';}
window.addEventListener('resize',scaleCanvas); scaleCanvas();
resetGame(); render(); window.yhazSnake={resetGame,startGame,restartGame};
})();
</script>
</body>
</html>